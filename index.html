<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Traffic Exam | Mrtechnician</title>
    <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #2563eb; --success: #16a34a; --danger: #dc2626; --dark: #0f172a; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Mukta', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: #f1f5f9; color: var(--dark); line-height: 1.6; }
        .navbar { background: var(--dark); color: white; padding: 1.2rem; text-align: center; position: sticky; top: 0; z-index: 100; }
        .navbar h1 { font-size: 1.4rem; }
        .navbar span { color: var(--primary); }
        .container { max-width: 500px; margin: auto; padding: 15px; }

        /* Folders */
        .folder { 
            background: white; padding: 20px; border-radius: 15px; text-align: center; 
            margin-bottom: 15px; border: 2px solid #e2e8f0; cursor: pointer;
            transition: transform 0.1s; box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .folder:active { transform: scale(0.96); background: #f1f5f9; }
        .dot { width: 50px; height: 50px; border-radius: 50%; display: inline-block; margin-bottom: 10px; }

        /* Quiz UI */
        #quiz-screen, #result-screen { background: white; padding: 20px; border-radius: 20px; display: none; min-height: 300px; }
        .q-header { display: flex; justify-content: space-between; margin-bottom: 15px; font-weight: bold; color: #64748b; }
        .option { 
            padding: 15px; border: 2px solid #e2e8f0; border-radius: 12px; 
            margin-bottom: 10px; cursor: pointer; font-size: 1.1rem;
        }
        .option.correct { background: #dcfce7; border-color: var(--success); color: #166534; }
        .option.wrong { background: #fee2e2; border-color: var(--danger); color: #991b1b; }
        .disabled { pointer-events: none; }
        .btn { width: 100%; padding: 15px; background: var(--dark); color: white; border: none; border-radius: 12px; font-size: 1.1rem; margin-top: 10px; cursor: pointer; }
        .hidden { display: none; }
    </style>

    <script>
        // Data and Logic inside Head to ensure it's defined before HTML renders
        const db = {
            easy: [
                {q:"रातो ट्राफिक बत्तीको अर्थ के हो ?", a:["जान पाइन्छ","बिस्तारै चलाउनु","रोकिनु","मोड लिनु"], c:2},
                {q:"हरियो बत्तीको अर्थ के हो ?", a:["रोकिनु","जान पाइन्छ","गति घटाउनु","साइड दिनु"], c:1},
                {q:"पहेंलो बत्तीले के जनाउँछ ?", a:["जानु","रोकिने तयारी","पार्किङ","गति बढाउनु"], c:1}
                // ... Note: Add other questions back here once tap is fixed
            ],
            hard: [
                {q:"सवारी चलाउँदा फोन प्रयोग ?", a:["सुरक्षित","अनुमति","निषेध","राम्रो"], c:2}
            ],
            expert: [
                {q:"चौराहामा प्राथमिकता कसलाई ?", a:["ठूलो","दायाँबाट आउने","पछाडिको","हर्न"], c:1}
            ]
        };

        let currentSet = [];
        let curIdx = 0;
        let score = 0;

        function startQuiz(lvl) {
            console.log("Starting level:", lvl);
            currentSet = db[lvl] || db.easy;
            curIdx = 0;
            score = 0;

            document.getElementById('folder-screen').style.display = 'none';
            document.getElementById('quiz-screen').style.display = 'block';
            document.getElementById('level-tag').innerText = lvl.toUpperCase();
            
            loadQ();
        }

        function loadQ() {
            const q = currentSet[curIdx];
            document.getElementById('progress').innerText = (curIdx + 1) + " / " + currentSet.length;
            document.getElementById('question-text').innerText = q.q;
            
            const box = document.getElementById('options-box');
            box.innerHTML = '';

            q.a.forEach((opt, i) => {
                const d = document.createElement('div');
                d.className = 'option';
                d.innerText = opt;
                d.onclick = function() { check(i, q.c, d); };
                box.appendChild(d);
            });
            document.getElementById('next-btn').classList.add('hidden');
        }

        function check(sel, cor, el) {
            const opts = document.querySelectorAll('.option');
            opts.forEach(o => o.classList.add('disabled'));
            if (sel === cor) {
                el.classList.add('correct');
                score++;
            } else {
                el.classList.add('wrong');
                opts[cor].classList.add('correct');
            }
            document.getElementById('next-btn').classList.remove('hidden');
        }

        function nextQuestion() {
            curIdx++;
            if (curIdx < currentSet.length) loadQ();
            else showFinal();
        }

        function showFinal() {
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';
            document.getElementById('score-display').innerText = score + " / " + currentSet.length;
        }
    </script>
</head>
<body>

    <nav class="navbar">
        <h1>MR. TECHNICIAN <span>TRAFFIC EXAM</span></h1>
    </nav>

    <div class="container">
        <div id="folder-screen">
            <h2 style="text-align: center; margin: 20px 0;">तह छान्नुहोस्</h2>
            
            <div class="folder" onclick="startQuiz('easy')">
                <span class="dot" style="background: var(--success);"></span>
                <h3>सजिलो (Easy)</h3>
            </div>

            <div class="folder" onclick="startQuiz('hard')">
                <span class="dot" style="background: orange;"></span>
                <h3>गाह्रो (Hard)</h3>
            </div>

            <div class="folder" onclick="startQuiz('expert')">
                <span class="dot" style="background: var(--danger);"></span>
                <h3>धेरै गाह्रो (Expert)</h3>
            </div>
        </div>

        <div id="quiz-screen">
            <div class="q-header">
                <span id="level-tag">LEVEL</span>
                <span id="progress">0/0</span>
            </div>
            <h2 id="question-text">Loading...</h2>
            <div id="options-box"></div>
            <button id="next-btn" class="btn hidden" onclick="nextQuestion()">अर्को प्रश्न →</button>
        </div>

        <div id="result-screen" style="text-align: center;">
            <h2>तपाईँको नतिजा</h2>
            <h1 id="score-display" style="font-size: 3rem; margin: 20px;">0/0</h1>
            <button class="btn" onclick="location.reload()">फेरि सुरु गर्नुहोस्</button>
        </div>
    </div>

</body>
</html>
